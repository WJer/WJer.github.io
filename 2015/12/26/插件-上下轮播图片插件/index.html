

<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>插件-上下轮播图片插件 | WJer&#39;s time</title>
  <meta name="author" content="WJer">
  
  <meta name="description" content="这是前端网看到的一个插件，样子还是挺不错的，于是研究了一下源码，力图吸取一些经验，将来，自己也可以写出高效而又美观的代码。
先看html，再看js源码附上js源码：
(function(A){//A就是jquery对象
A.fn.th_video_focus=function(E){//E为参数信息">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="插件-上下轮播图片插件"/>
  <meta property="og:site_name" content="WJer&#39;s time"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.ico" rel="icon" type="image/x-ico">
  <link rel="alternate" href="/atom.xml" title="WJer&#39;s time" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
  <script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Ffe3814b5f53cc394a493cbeb2368f2af' type='text/javascript'%3E%3C/script%3E"));
</script>


<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-41207871-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


</head>


<body>
  <header id="header" class="inner">
<div class="alignleft">
  <h1><a href="/">WJer&#39;s time</a></h1>
  <h2><a href="/">Windy,only try to survive</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">首页</a></li>
    
      <li><a href="/archives">归档</a></li>
    
      <li><a href="/about">关于</a></li>
    
  </ul>
  <div class="clearfix"></div>
  
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-12-26T14:02:23.000Z"><a href="/2015/12/26/插件-上下轮播图片插件/">2015-12-26</a></time>
      
      
  
    <h1 class="title">插件-上下轮播图片插件</h1>
  

    </header>
    <div class="entry">
      
        <p>这是前端网看到的一个插件，样子还是挺不错的，于是研究了一下源码，力图吸取一些经验，将来，自己也可以写出高效而又美观的代码。</p>
<p>先看html，再看js源码<br>附上js源码：</p>
<pre><code><span class="list">(<span class="keyword">function</span><span class="list">(<span class="keyword">A</span>)</span><span class="collection">{//A就是jquery对象
A.fn.th_video_focus=function<span class="list">(<span class="keyword">E</span>)</span><span class="collection">{//E为参数信息        
    var G=<span class="collection">{//默认的参数
        actClass:<span class="string">"cur"</span>,
        navContainerClass:<span class="string">".focus_pic_preview"</span>,
        focusContainerClass:<span class="string">".focus_pic"</span>,
        animTime:600,
        delayTime:5000
    }</span><span class="comment">;</span>
    if<span class="list">(<span class="keyword">E</span>)</span><span class="collection">{
        A.extend<span class="list">(<span class="keyword">G</span>,E)</span><span class="comment">;</span>
    }</span>        
    var C=G.actClass;
    var D=G.navContainerClass;
    var B=G.focusContainerClass;
    var F=G.animTime;
    var H=G.delayTime;
    var I=null;
    return this.each<span class="list">(<span class="keyword">function</span><span class="list">()</span><span class="collection">{    
        var O=A<span class="list">(<span class="keyword">this</span>)</span><span class="comment">;</span>
        var M=A<span class="list">(<span class="keyword">D+</span><span class="string">" li"</span>,O)</span><span class="comment">;</span>
        var P=A<span class="list">(<span class="keyword">B+</span><span class="string">" li"</span>,O)</span><span class="comment">;</span>
        var L=M.length;
        var K=O.height<span class="list">()</span><span class="comment">;</span>
        function N<span class="list">(<span class="keyword">R</span>)</span><span class="collection">{//轮播动作
            var V=K*R*<span class="list">(<span class="keyword">-1</span>)</span><span class="comment">;</span>
            A<span class="list">(<span class="keyword">B</span>,O)</span>.stop<span class="list">()</span>.animate<span class="list">(<span class="collection">{top:V}</span>,F,function<span class="list">()</span><span class="collection">{
                var Y=O.find<span class="list">(<span class="string">"h3"</span>)</span>, X=Y.height<span class="list">()</span><span class="comment">;</span>
                Y.height<span class="list">(<span class="number">0</span>)</span>
                   .html<span class="list">(<span class="keyword">A</span><span class="list">(<span class="keyword">B+</span><span class="string">" li"</span>)</span>
                   .eq<span class="list">(<span class="keyword">R</span>)</span>.find<span class="list">(<span class="string">"img"</span>)</span>
                      .attr<span class="list">(<span class="string">"alt"</span>)</span>)</span>
                     .animate<span class="list">(<span class="collection">{height:X}</span>,<span class="number">600</span>)</span>
            }</span>)</span><span class="comment">;</span>
            A<span class="list">(<span class="keyword">D+</span><span class="string">" li"</span>)</span>.eq<span class="list">(<span class="keyword">R</span>)</span>
                        .addClass<span class="list">(<span class="keyword">C</span>)</span>
                        .siblings<span class="list">()</span>
                        .removeClass<span class="list">(<span class="keyword">C</span>)</span><span class="comment">;</span>
        }</span>            
        function Q<span class="list">()</span><span class="collection">{//清除循环，设定轮播动作循环
            if<span class="list">(<span class="keyword">I</span>)</span><span class="collection">{
                clearInterval<span class="list">(<span class="keyword">I</span>)</span>
            }</span>
            I=setInterval<span class="list">(<span class="keyword">function</span><span class="list">()</span><span class="collection">{
                var R=A<span class="list">(<span class="keyword">D+</span><span class="string">" li."</span>+C)</span>.index<span class="list">()</span><span class="comment">;</span>
                N<span class="list">(<span class="list">(<span class="keyword">R+1</span>)</span>%L)</span>
            }</span>,H)</span><span class="comment">;</span>
        }</span>    
        O.hover<span class="list">(<span class="keyword">function</span><span class="list">()</span><span class="collection">{
                    if<span class="list">(<span class="keyword">I</span>)</span><span class="collection">{
                        clearInterval<span class="list">(<span class="keyword">I</span>)</span>
                    }</span>
                }</span>,function<span class="list">()</span><span class="collection">{
                    Q<span class="list">()</span>
                }</span>)</span><span class="comment">;        </span>
            var J=null;
        M.hover<span class="list">(<span class="keyword">function</span><span class="list">()</span><span class="collection">{                
            var R=A<span class="list">(<span class="keyword">this</span>)</span>.index<span class="list">()</span><span class="comment">;            </span>
            if<span class="list">(<span class="keyword">I</span>)</span><span class="collection">{
                clearInterval<span class="list">(<span class="keyword">I</span>)</span>
            }</span>
            J=setTimeout<span class="list">(<span class="keyword">function</span><span class="list">()</span><span class="collection">{
                N<span class="list">(<span class="keyword">R</span>)</span>
            }</span>,<span class="number">300</span>)</span>
        }</span>,function<span class="list">()</span><span class="collection">{
            if<span class="list">(<span class="keyword">J</span>)</span><span class="collection">{
                clearTimeout<span class="list">(<span class="keyword">J</span>)</span>
            }</span>
            Q<span class="list">()</span><span class="comment">;</span>
        }</span>)</span><span class="comment">;            </span>
        Q<span class="list">()</span><span class="comment">;    </span>
    }</span>)</span>
}</span></span></span>
</code></pre><p>})(jQuery);</p>
<p>这样的命名太无奈了，竟然使用大写的字母，根本分不清哪个变量是干嘛用的。我换了一下变量名称，以求大家更容易理解。</p>
<p>附上html源码：</p>
<pre><code><span class="doctype">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;</span>
<span class="tag">&lt;<span class="title">html</span> <span class="attribute">xmlns</span>=<span class="value">"http://www.w3.org/1999/xhtml"</span>&gt;</span>
<span class="tag">&lt;<span class="title">head</span>&gt;</span>
<span class="tag">&lt;<span class="title">meta</span> <span class="attribute">http-equiv</span>=<span class="value">"Content-Type"</span> <span class="attribute">content</span>=<span class="value">"text/html; charset=utf-8"</span> /&gt;</span>
<span class="tag">&lt;<span class="title">title</span>&gt;</span>5屏jQuery上下轮播焦点图代码 - 中国前端网<span class="tag">&lt;/<span class="title">title</span>&gt;</span>
<span class="tag">&lt;<span class="title">link</span> <span class="attribute">href</span>=<span class="value">"css/cnqianduan.css"</span> <span class="attribute">media</span>=<span class="value">"screen"</span> <span class="attribute">rel</span>=<span class="value">"stylesheet"</span> <span class="attribute">type</span>=<span class="value">"text/css"</span>/&gt;</span>
<span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span> <span class="attribute">src</span>=<span class="value">"js/jquery-1.8.3.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span> 
<span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span> <span class="attribute">src</span>=<span class="value">"js/cnqianduan.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span> 
<span class="tag">&lt;/<span class="title">head</span>&gt;</span>
<span class="tag">&lt;<span class="title">body</span>&gt;</span>
<span class="comment">&lt;!--焦点图--&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"film_focus"</span>&gt;</span>
      <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"film_focus_desc"</span>&gt;</span>
            <span class="tag">&lt;<span class="title">h3</span>&gt;</span>中国前端网 - www.cnqianduan.com<span class="tag">&lt;/<span class="title">h3</span>&gt;</span>
            <span class="tag">&lt;<span class="title">ul</span> <span class="attribute">class</span>=<span class="value">"film_focus_nav"</span>&gt;</span>
                  <span class="tag">&lt;<span class="title">li</span> <span class="attribute">class</span>=<span class="value">"cur"</span>&gt;</span> <span class="tag">&lt;<span class="title">b</span>&gt;</span>长标题1<span class="tag">&lt;/<span class="title">b</span>&gt;</span><span class="tag">&lt;<span class="title">span</span>&gt;</span>短标题1<span class="tag">&lt;/<span class="title">span</span>&gt;</span> <span class="tag">&lt;/<span class="title">li</span>&gt;</span>
                  <span class="tag">&lt;<span class="title">li</span>&gt;</span> <span class="tag">&lt;<span class="title">b</span>&gt;</span>长标题2<span class="tag">&lt;/<span class="title">b</span>&gt;</span><span class="tag">&lt;<span class="title">span</span>&gt;</span>短标题2<span class="tag">&lt;/<span class="title">span</span>&gt;</span> <span class="tag">&lt;/<span class="title">li</span>&gt;</span>
                  <span class="tag">&lt;<span class="title">li</span>&gt;</span> <span class="tag">&lt;<span class="title">b</span>&gt;</span>长标题3<span class="tag">&lt;/<span class="title">b</span>&gt;</span><span class="tag">&lt;<span class="title">span</span>&gt;</span>短标题3<span class="tag">&lt;/<span class="title">span</span>&gt;</span> <span class="tag">&lt;/<span class="title">li</span>&gt;</span>
                  <span class="tag">&lt;<span class="title">li</span>&gt;</span> <span class="tag">&lt;<span class="title">b</span>&gt;</span>长标题4<span class="tag">&lt;/<span class="title">b</span>&gt;</span><span class="tag">&lt;<span class="title">span</span>&gt;</span>短标题4<span class="tag">&lt;/<span class="title">span</span>&gt;</span> <span class="tag">&lt;/<span class="title">li</span>&gt;</span>
                  <span class="tag">&lt;<span class="title">li</span>&gt;</span> <span class="tag">&lt;<span class="title">b</span>&gt;</span>长标题5<span class="tag">&lt;/<span class="title">b</span>&gt;</span><span class="tag">&lt;<span class="title">span</span>&gt;</span>短标题5<span class="tag">&lt;/<span class="title">span</span>&gt;</span> <span class="tag">&lt;/<span class="title">li</span>&gt;</span>
            <span class="tag">&lt;/<span class="title">ul</span>&gt;</span>
      <span class="tag">&lt;/<span class="title">div</span>&gt;</span>
      <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"film_focus_imgs_wrap"</span>&gt;</span>
            <span class="tag">&lt;<span class="title">ul</span> <span class="attribute">class</span>=<span class="value">"film_focus_imgs"</span>&gt;</span>
                  <span class="tag">&lt;<span class="title">li</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">target</span>=<span class="value">"_blank"</span> <span class="attribute">href</span>=<span class="value">"http://www.cnqianduan.com"</span>&gt;</span><span class="tag">&lt;<span class="title">img</span>  <span class="attribute">src</span>=<span class="value">"images/a1.jpg"</span> <span class="attribute">alt</span>=<span class="value">"标题1"</span> /&gt;</span><span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
                  <span class="tag">&lt;<span class="title">li</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">target</span>=<span class="value">"_blank"</span> <span class="attribute">href</span>=<span class="value">"http://www.cnqianduan.com"</span>&gt;</span><span class="tag">&lt;<span class="title">img</span>  <span class="attribute">src</span>=<span class="value">"images/a2.jpg"</span> <span class="attribute">alt</span>=<span class="value">"标题2"</span> /&gt;</span><span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
                  <span class="tag">&lt;<span class="title">li</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">target</span>=<span class="value">"_blank"</span> <span class="attribute">href</span>=<span class="value">"http://www.cnqianduan.com"</span>&gt;</span><span class="tag">&lt;<span class="title">img</span> <span class="attribute">src</span>=<span class="value">"images/a3.jpg"</span> <span class="attribute">alt</span>=<span class="value">"标题3"</span> /&gt;</span><span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
                  <span class="tag">&lt;<span class="title">li</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">target</span>=<span class="value">"_blank"</span> <span class="attribute">href</span>=<span class="value">"http://www.cnqianduan.com"</span>&gt;</span><span class="tag">&lt;<span class="title">img</span>  <span class="attribute">src</span>=<span class="value">"images/a4.jpg"</span> <span class="attribute">alt</span>=<span class="value">"标题4"</span> /&gt;</span><span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
                 <span class="tag">&lt;<span class="title">li</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">target</span>=<span class="value">"_blank"</span> <span class="attribute">href</span>=<span class="value">"http://www.cnqianduan.com"</span>&gt;</span><span class="tag">&lt;<span class="title">img</span>  <span class="attribute">src</span>=<span class="value">"images/a5.jpg"</span> <span class="attribute">alt</span>=<span class="value">"标题5"</span> /&gt;</span><span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
            <span class="tag">&lt;/<span class="title">ul</span>&gt;</span>
      <span class="tag">&lt;/<span class="title">div</span>&gt;</span>
<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
<span class="comment">&lt;!--焦点图END--&gt;</span> 
<span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span>&gt;</span><span class="javascript">
$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>{
    $(<span class="string">".film_focus"</span>).th_video_focus({
        navContainerClass:<span class="string">".film_focus_nav"</span>,
        focusContainerClass:<span class="string">".film_focus_imgs"</span>,
        delayTime:<span class="number">3000</span>
    });

});    
</span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
<span class="tag">&lt;/<span class="title">body</span>&gt;</span>
<span class="tag">&lt;/<span class="title">html</span>&gt;</span>
</code></pre><p>用过Jquery的都知道，为了避免$冲突，可以通过匿名函数的方式替换掉$,使用其他的名称，我们暂且使用jquery吧。</p>
<pre><code><span class="list">(<span class="keyword">function</span><span class="list">(<span class="keyword">jquery</span>)</span><span class="collection">{
    //这里jquery就相当于$
}</span>)</span><span class="list">(<span class="keyword">jQuery</span>)</span><span class="comment">;</span>
</code></pre><p>想一个方法名，就lunbo吧，简单从粗暴。然后添加到jQuery对象中，设置一个参数，传递的是对象。<br><em>为什么要传递对象，在java中数组、集合都能作为保存数据容器，但是在js中，对象是最好的选择，它可以保存各式各样的数据。</em></p>
<pre><code>jquery.fn.lunbo=<span class="function"><span class="keyword">function</span><span class="params">(paramObj)</span></span>{
    ......
}
</code></pre><p>如果你调用lunbo方法，不传递参数,那么就应该要有一些默认的设置：</p>
<pre><code>var defaultObj={
    actClass:<span class="string">"cur"</span>,<span class="comment">//聚焦的样式</span>
    navContainerClass:<span class="string">".focus_pic_preview"</span>,<span class="comment">//左侧的标题nav</span>
    focusContainerClass:<span class="string">".focus_pic"</span>,<span class="comment">//右侧的图片列表</span>
    animTime:<span class="number">600</span>,<span class="comment">//动作完成的时间</span>
    delayTime:<span class="number">5000</span><span class="comment">//循环的周期</span>
}
</code></pre><p>默认的设置好了，如果传递参数，怎么去覆盖默认值呢？</p>
<pre><code><span class="keyword">if</span>(paramObj){
    jquery.<span class="keyword">extend</span>(defaultObj,paramObj);
}
</code></pre><p>如果要用到默认值中的某个属性，总是通过obj.attribute是不是很麻烦？拿出来保存到变量中吧。</p>
<pre><code>var cur=<span class="keyword">default</span>Obj.actClass,
    navClass=<span class="keyword">default</span>Obj.navContainerClass,
    focusClass=<span class="keyword">default</span>Obj.focusContainerClass,
    animate=<span class="keyword">default</span>Obj.animTime,
    delay=<span class="keyword">default</span>Obj.delayTime;
</code></pre><p>顺便获取dom对象吧。</p>
<pre><code>var film_focus=jquery(<span class="keyword">this</span>),<span class="comment">//最外层的那个div</span>
    nav=jquery(navClass+<span class="string">" li"</span>,film_focus),<span class="comment">//获取左侧的文字li</span>
    imgs=jquery(focusClass+<span class="string">" li"</span>,film_focus),<span class="comment">//获取右侧的图片li</span>
    liamount=nav.length,<span class="comment">//获取左侧文字li的数量</span>
    <span class="variable">height</span>=film_focus.<span class="variable">height</span>();<span class="comment">//获取一张图片的高度</span>
</code></pre><p>图片轮播这个动作是一个单独的方法，这样可以多次调用。它需要一个下标参数，用来保存哪个nav获得聚焦，图片需要移动多少px。</p>
<pre><code><span class="function"><span class="keyword">function</span> <span class="title">imgmove</span><span class="params">(index)</span></span>{
    <span class="keyword">var</span> newtop=index*height*(-<span class="number">1</span>);<span class="comment">//计算图片移动的位置</span>
    jquery(focusClass,film_focus)<span class="comment">//获取图片列表</span>
        .stop()<span class="comment">//移动停止</span>
        .animate({top:newtop},animate,<span class="function"><span class="keyword">function</span><span class="params">()</span></span>{<span class="comment">//开始移动</span>
            <span class="keyword">var</span> h3=film_focus.find(<span class="string">"h3"</span>),
                h3_height=h3.height();<span class="comment">//获取h3高度</span>
                h3
                    .height(<span class="number">0</span>)<span class="comment">//h3消失</span>
                    .html(imgs.eq(index).find(<span class="string">'img'</span>).attr(‘alt’))<span class="comment">//修改h3的内容</span>
                    .animate({height:h3_height},<span class="number">600</span>)<span class="comment">//h3出现</span>
        });
        nav.eq(index).addClass(cur).siblings().removeClass(cur);<span class="comment">//左侧显示指定的文字li        </span>
}
</code></pre><p>如果不点击左侧的nav，图片应该循环轮播。</p>
<pre><code>var <span class="built_in">circle</span>=null;<span class="comment">//循环事件</span>
<span class="function"><span class="keyword">function</span> <span class="title">autoLunbo</span><span class="params">()</span>{</span>
    <span class="keyword">if</span>(<span class="built_in">circle</span>){
        clearInterval(<span class="built_in">circle</span>);<span class="comment">//清除循环事件</span>
    }
    <span class="built_in">circle</span>=setInterval(<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
        var index=jquery(navClass+<span class="string">" li."</span>+cur).index();
        imgmove((index+<span class="number">1</span>)<span class="built_in">%</span>liamount);
    },delay);
}
</code></pre><p>如果鼠标放上去，图片应该停止轮播;拿开继续轮播</p>
<pre><code>film_focus.hover(<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
    <span class="keyword">if</span>(<span class="built_in">circle</span>){
        clearInterval(<span class="built_in">circle</span>);
    }
},<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
    autoLunbo();
});
</code></pre><p>如果鼠标放在nav上，就要轮播到相对应的图片</p>
<pre><code><span class="keyword">var</span> J=<span class="literal">null</span>;
nav.hover(<span class="function"><span class="keyword">function</span><span class="params">()</span></span>{
    <span class="keyword">var</span> index=jquery.index();<span class="comment">//获取鼠标停在li的下标</span>
    <span class="keyword">if</span>(circle){
        clearInterval(circle);<span class="comment">//停止轮播</span>
    }
    J=setTimeout(<span class="function"><span class="keyword">function</span><span class="params">()</span></span>{
        imgmove(index);<span class="comment">//图片移动到指定位置</span>
    },<span class="number">300</span>);

},<span class="function"><span class="keyword">function</span><span class="params">()</span></span>{
    <span class="keyword">if</span>(J){
        clearTimeout(J);
    }
    autoLunbo();<span class="comment">//继续从当前位置开始轮播</span>
});
</code></pre><p>我们为了保持jquery对象的链式调用方法，需要`return this.each(function(){……})</p>
<p>最后整理一下，得到如下代码：</p>
<pre><code>(<span class="function"><span class="keyword">function</span><span class="params">(jquery)</span></span>{
jquery.fn.lunbo=<span class="function"><span class="keyword">function</span><span class="params">(paramObj)</span></span>{
    <span class="keyword">var</span> <span class="keyword">default</span>={
        actClass:<span class="string">"cur"</span>,<span class="comment">//聚焦的样式</span>
        navContainerClass:<span class="string">".focus_pic_preview"</span>,<span class="comment">//左侧的标题nav</span>
        focusContainerClass:<span class="string">".focus_pic"</span>,<span class="comment">//右侧的图片列表</span>
        animTime:<span class="number">600</span>,<span class="comment">//动作完成的时间</span>
        delayTime:<span class="number">5000</span><span class="comment">//循环的周期</span>
    };

    <span class="keyword">var</span> cur=<span class="keyword">default</span>.actClass,
        navClass=<span class="keyword">default</span>.navContainerClass,
        focusClass=<span class="keyword">default</span>.focusContainerClass,
        animate=<span class="keyword">default</span>.animTime,
        delay=<span class="keyword">default</span>.delayTime;

    <span class="keyword">var</span> film_focus=jquery(<span class="keyword">this</span>),<span class="comment">//最外层的那个div</span>
        nav=jquery(navClass+<span class="string">" li"</span>,film_focus),<span class="comment">//获取左侧的文字li</span>
        imgs=jquery(focusClass+<span class="string">" li"</span>,film_focus),<span class="comment">//获取右侧的图片li</span>
        liamount=film_focus_nav.length,<span class="comment">//获取左侧文字li的数量</span>
        height=film_focus.height();<span class="comment">//获取一张图片的高度</span>

    <span class="keyword">return</span> <span class="keyword">this</span>.<span class="keyword">each</span>(<span class="function"><span class="keyword">function</span><span class="params">()</span></span>{
        <span class="function"><span class="keyword">function</span> <span class="title">imgmove</span><span class="params">(index)</span></span>{
        <span class="keyword">var</span> newtop=index*height*(-<span class="number">1</span>);<span class="comment">//计算图片移动的位置</span>
        jquery(focusClass,film_focus)<span class="comment">//获取图片列表</span>
            .stop()<span class="comment">//移动停止</span>
            .animate({top:newtop},animate,<span class="function"><span class="keyword">function</span><span class="params">()</span></span>{<span class="comment">//开始移动</span>
                <span class="keyword">var</span> h3=film_focus.find(<span class="string">"h3"</span>),
                    h3_height=h3.height();<span class="comment">//获取h3高度</span>
                    h3
                        .height(<span class="number">0</span>)<span class="comment">//h3消失</span>
                        .html(imgs.eq(index).find(<span class="string">'img'</span>).attr(‘alt’))<span class="comment">//修改h3的内容</span>
                        .animate({height:h3_height},<span class="number">600</span>)<span class="comment">//h3出现</span>
            });
            nav.eq(index).addClass(cur).siblings().removeClass(cur);<span class="comment">//左侧显示指定的文字li        </span>
        }

        <span class="keyword">var</span> circle=<span class="literal">null</span>;<span class="comment">//循环事件</span>
        <span class="function"><span class="keyword">function</span> <span class="title">autoLunbo</span><span class="params">()</span></span>{
            <span class="keyword">if</span>(circle){
                clearInterval(circle);<span class="comment">//清除循环事件</span>
            }
            circle=setInterval(<span class="function"><span class="keyword">function</span><span class="params">()</span></span>{
                <span class="keyword">var</span> index=jquery(nav+<span class="string">" li."</span>+cur);
                imgmove((index+<span class="number">1</span>)%liamount);
            },delay);
        }

        film_focus.hover(<span class="function"><span class="keyword">function</span><span class="params">()</span></span>{
            <span class="keyword">if</span>(circle){
                clearInterval(circle);
            }
        },<span class="function"><span class="keyword">function</span><span class="params">()</span></span>{
            autoLunbo();
        });

        <span class="keyword">var</span> J=<span class="literal">null</span>;
        nav.hover(<span class="function"><span class="keyword">function</span><span class="params">()</span></span>{
            <span class="keyword">var</span> index=jquery.index();<span class="comment">//获取鼠标停在li的下标</span>
            <span class="keyword">if</span>(circle){
                clearInterval(circle);<span class="comment">//停止轮播</span>
            }
            J=setTimeout(<span class="function"><span class="keyword">function</span><span class="params">()</span></span>{
                imgmove(index);<span class="comment">//图片移动到指定位置</span>
            },<span class="number">300</span>);

        },<span class="function"><span class="keyword">function</span><span class="params">()</span></span>{
            <span class="keyword">if</span>(J){
                clearTimeout(J);
            }
            autoLunbo();<span class="comment">//继续从当前位置开始轮播</span>
        });

        autoLunbo();
    })
}})(jQuery);
`
</code></pre>
      
    </div>
    <footer>
      
        
  
  <div class="categories">
    <a href="/categories/插件/">插件</a>
  </div>

        
        <!--分享的模块-->
<!-- Baidu Button BEGIN -->
<div id="bdshare" class="bdshare_t bds_tools_32 get-codes-bdshare">
<a class="bds_qzone"></a>
<a class="bds_tsina"></a>
<a class="bds_tqq"></a>
<a class="bds_renren"></a>
<a class="bds_t163"></a>
<span class="bds_more"></span>
<a class="shareCount"></a>
</div>
<script type="text/javascript" id="bdshare_js" data="type=tools&amp;uid=3326447" ></script>
<script type="text/javascript" id="bdshell_js"></script>
<script type="text/javascript">
document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion=" + Math.ceil(new Date()/3600000)
</script>
<!-- Baidu Button END -->      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">

<!-- Duoshuo Comment BEGIN -->
	<div class="ds-thread"></div>
<script type="text/javascript">
var duoshuoQuery = {short_name:"wjer"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
<!-- Duoshuo Comment END -->  

  
</section>
</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜尋">
    <input type="hidden" name="q" value="site:yoursite.com">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">分類</h3>
  <ul class="entry">
  
    <li><a href="/categories/HTML5/">HTML5</a><small>1</small></li>
  
    <li><a href="/categories/Linux/">Linux</a><small>2</small></li>
  
    <li><a href="/categories/backbonejs/">backbonejs</a><small>3</small></li>
  
    <li><a href="/categories/bootstrap/">bootstrap</a><small>1</small></li>
  
    <li><a href="/categories/css/">css</a><small>3</small></li>
  
    <li><a href="/categories/hexo/">hexo</a><small>2</small></li>
  
    <li><a href="/categories/jquery/">jquery</a><small>1</small></li>
  
    <li><a href="/categories/js/">js</a><small>18</small></li>
  
    <li><a href="/categories/linux/">linux</a><small>3</small></li>
  
    <li><a href="/categories/node-js/">node.js</a><small>2</small></li>
  
    <li><a href="/categories/推荐/">推荐</a><small>1</small></li>
  
    <li><a href="/categories/插件/">插件</a><small>1</small></li>
  
    <li><a href="/categories/浏览器/">浏览器</a><small>2</small></li>
  
  </ul>
</div>


  <div class="widget tag">
<h3 class="title">个人介绍</h3>
<ul class="entry">

<li><img src="/imgs/jinmu.jpg" style="width:100%"/></li>
<li>博主：吴敬</li>
<li>星座：双鱼座</li>
<li>现状：合肥工业大学本科生</li>
<li>想要约我的<a href="×××" title="QQ:1025620771">联系我</a>！</li>
<!--
<li><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=230 height=86 src="http://music.163.com/outchain/player?type=2&id=39443443&auto=1&height=66"></iframe></li>
-->
</ul>
</div>



  <iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src=""></iframe>
</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2016 WJer
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>



